jQuery(document).ready(function(){var a={init:function(){jQuery("#mmc_email_input").bind("keyup",function(){jQuery(".mmc_button").removeClass("mmc_unfollow mmc_pending").addClass("mmc_follow")});jQuery("#mmc_subscription_check").click(function(b){b.preventDefault();jQuery(".mmc_button").removeClass("mmc_follow mmc_unfollow mmc_pending").addClass("mmc_loading");a.checkSubscriptions(function(f){if(f.status=="update"&&f.message){var e=f.message;var g={};for(var c=0;c<e.length;c++){g=e[c];var d=(g.isSubscribed)?"mmc_unfollow":"mmc_follow";jQuery(".mmc_list_row[data-id="+g.id+"] .mmc_button").removeClass("mmc_follow mmc_pending mmc_loading mmc_unfollow").addClass(d)}}else{jQuery(".mmc_button").removeClass("mmc_follow mmc_pending mmc_loading mmc_unfollow").addClass("mmc_follow");if(f.status=="error"){a.showError(f.message)}}})});jQuery(".mmc_button").click(function(c){c.preventDefault();var b=jQuery(this);if(b.hasClass("mmc_follow")||b.hasClass("mmc_pending")){b.removeClass("mmc_follow mmc_pending").addClass("mmc_loading");a.subscribe(b.parents(".mmc_list_row").data("id"),function(e){var d="mmc_unfollow";if(e.status=="error"){d="mmc_follow";a.showError(e.message)}else{if(e.status=="pending"){d="mmc_pending"}}b.removeClass("mmc_follow mmc_loading").addClass(d)})}else{if(b.hasClass("mmc_unfollow")||b.hasClass("mmc_pending")){b.removeClass("mmc_unfollow mmc_pending").addClass("mmc_loading");a.unsubscribe(b.parents(".mmc_list_row").data("id"),function(e){var d="mmc_follow";if(e.status=="error"){d="mmc_unfollow";a.showError(e.message)}else{if(e.status=="pending"){d="mmc_pending"}}b.removeClass("mmc_unfollow mmc_loading").addClass(d)})}}})},checkSubscriptions:function(d){var b="";var c=jQuery("#mmc_email_input");if(c.length==1){b=c.val()}jQuery.ajax({type:"POST",data:{mmc_ajax:1,mmc_action:"checkSubscriptions",mmc_email:b},success:d})},subscribe:function(e,d){var b="";var c=jQuery("#mmc_email_input");if(c.length==1){b=c.val()}jQuery.ajax({type:"POST",data:{mmc_ajax:1,mmc_id:e,mmc_action:"subscribe",mmc_email:b},success:d})},unsubscribe:function(e,d){var b="";var c=jQuery("#mmc_email_input");if(c.length==1){b=c.val()}jQuery.ajax({type:"POST",data:{mmc_ajax:1,mmc_id:e,mmc_action:"unsubscribe",mmc_email:b},success:d})},showError:function(b){jQuery("#mmc_error").text(b).fadeIn("fast").delay(5000).fadeOut("slow")}};a.init()});